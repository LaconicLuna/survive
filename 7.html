<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ripples</title>
    <style>
        body {
            margin: 0;
            background-color: #0e0e0e;
            overflow: hidden;
            font-family: monospace;
        }

        #controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #0e0e0e;
            color: #e0e0e0;
            padding: 8px 16px;
            border-radius: 8px;
            z-index: 10;
        }


        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>

<body>
    <div id="controls">
        <input type="range" id="strengthSlider" min="0.002" max="0.01" step="0.0001" value="0.01">
        <label for="strengthSlider">Yes: <span id="strengthValue">0.01</span></label>
        <input type="color" id="colorPicker" value="#0000ff">
        <label for="colorPicker">Ripple Color</label>
        <input type="range" id="wavelengthSlider" min="0.01" max="0.20" step="0.01" value="0.05">
        <label for="wavelengthSlider">Wavelength: <span id="wavelengthValue">0.05</span></label>

    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const controlsHeight = 50; // Adjust if needed
        canvas.height = window.innerHeight - controlsHeight;
        let rippleColor = document.getElementById("colorPicker").value;

        const colorPicker = document.getElementById("colorPicker");
        colorPicker.addEventListener("input", () => {
            rippleColor = colorPicker.value;
        });

        strength = 0.01;
        const gridSize = 10;
        const squares = [];
        ripples = [];
        strength = parseFloat(document.getElementById("strengthSlider").value);
        let wavelengthFactor = parseFloat(document.getElementById("wavelengthSlider").value);

        const wavelengthSlider = document.getElementById("wavelengthSlider");
        const wavelengthDisplay = document.getElementById("wavelengthValue");

        wavelengthSlider.addEventListener("input", () => {
            wavelengthFactor = parseFloat(wavelengthSlider.value);
            wavelengthDisplay.textContent = wavelengthFactor.toFixed(2);
        });

        const slider = document.getElementById("strengthSlider");
        const display = document.getElementById("strengthValue");

        slider.addEventListener("input", () => {
            strength = parseFloat(slider.value);
            display.textContent = strength.toFixed(3);
        });

        for (let x = 0; x < canvas.width; x += gridSize) {
            for (let y = 0; y < canvas.height; y += gridSize) {
                squares.push({ x, y, intensity: 0 });
            }
        }

        function createRipple(x, y) {
            ripples.push({ x, y, time: 0 });
        }

        function getDistance(x1, y1, x2, y2) {
            const dx = x2 - x1;
            const dy = y2 - y1;
            return Math.sqrt(dx * dx + dy * dy);
        }
        function hexToRGB(hex) {
            const bigint = parseInt(hex.slice(1), 16);
            const r = (bigint >> 16) & 255;
            const g = (bigint >> 8) & 255;
            const b = bigint & 255;
            return { r, g, b };
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let square of squares) {
                let total = 0;
                for (let ripple of ripples) {
                    const dist = getDistance(square.x, square.y, ripple.x, ripple.y);
                    const wave = Math.sin(dist * wavelengthFactor - ripple.time * 0.15);


                    const falloff = Math.exp(-dist * strength);
                    total += wave * falloff;

                }


                const { r, g, b } = hexToRGB(rippleColor);

                const intensity = Math.max(0, total);
                ctx.fillStyle = `rgb(${r * intensity}, ${g * intensity}, ${b * intensity})`;

                ctx.fillRect(square.x, square.y, gridSize, gridSize);
            }

            for (let ripple of ripples) {
                ripple.time += 1;
            }

            requestAnimationFrame(draw);
        }

        canvas.addEventListener("click", (e) => {
            createRipple(e.clientX, e.clientY);
        });

        canvas.addEventListener("touchstart", (e) => {
            e.preventDefault();
            for (let t of e.touches) {
                createRipple(t.clientX, t.clientY);
            }
        });

        draw();
    </script>
</body>

</html>
